<head><title>Dados | SE</title></head><%=render 'header'%><%= render 'datas' %>
<%= form_with html: { autocomplete: 'off' }, novalidate: true  do |form| %>
    <%= form.label :question, "Questão:"%> 
    <%= form.text_field :question, required: true, class: 'input-data', autofocus: true %> 
    <%= form.file_field :image, id: 'image', class: 'd-none'%>
    <%= image_tag('', id: 'hiddenImage')%>
    <% cookies[:reuse_image] == '1' ? @checked = '1' : @checked = '0' %>
    <div id='imaging' class='d-inline-block'></div><br>
    <div id='ansices'></div>
    <div id='questiontype'></div><br>
    <div id='tags'></div><br>
    <%= form.label :subject, "Para que disciplina?" %>
    <select name='subject' class='form-select'>
    <% @subjects.each do |subject|%>
    <option value='<%= subject.id %>'<%= cookies[:subject] == subject.id.to_s ? ' selected' : ''%> ><%= subject.title %></option>
    <% end %>
    </select>
    <div id='levels'></div>
    <div id='parameters'></div><br>
    <div class='d-grid'>
      <%= form.submit "Submeter Questão", class: 'btn btn-primary' %>
    </div>
<% end %>
<br></div>
<div class='bg-primary p-1 text-white align-middle'><b><%= fa_icon 'comment', class: 'align-middle'%> Questões Definidas</b></div>
<div id='navigate_questions'></div>
<script>
<% if cookies[:level] && cookies[:types] && cookies[:choices] && cookies[:reuse_image] && cookies[:tags] && %>
<% cookies[:parameters] %>
const level = <%= cookies[:level].to_i %>;
const types = <%= cookies[:types] %>;
const choices = <%= cookies[:choices] %>;
const reuse_image = <%= cookies[:reuse_image] %>;
const temas = <%= raw cookies[:tags].to_s %>;
const parameters = <%= cookies[:parameters] %>;
<% else %>
const level = 1;
const types = [0];
const choices = 0;
const reuse_image = "false";
const temas = [];
const parameters = [];
<% end %>
let existing_tags = <%= raw @tags.to_s %>
let questions = [];
let subjects = {};
<% Subject.all.each do |subject| %>
subjects[<%= subject.id.to_s %>] = "<%= subject.title.to_s %>";
<% end %>
<% Question.all.each do |question| %>
questions.push({id: <%= raw question.id.to_s %>, subject: <%= question.subject_id%>, level: <%= question.level.to_s %>,
question: "<%= question.question.to_s %>", answers: <%= raw question.answer.to_s %>, 
tags: <%= raw question.tags.to_s %>, frequency: <%= question.frequency.to_s %>,
parameters: <%= raw question.parameters.to_s %> })
<% end %>
</script>
